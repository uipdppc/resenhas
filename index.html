<!-- Desenvolvido por Marcos Matos e Vinicius Coelho 2022 -->
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RESENHAS E OPERA√á√ïES</title>
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-6QHDQW2J6H"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-6QHDQW2J6H');
  </script>

  <!-- jQuery -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <!-- jQuery UI -->
  <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
  <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/themes/smoothness/jquery-ui.css">
  <!-- Timepicker Addon -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-ui-timepicker-addon/1.6.3/jquery-ui-timepicker-addon.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-ui-timepicker-addon/1.6.3/jquery-ui-timepicker-addon.min.css">
  <!-- Slider Access  -->
  <script src="https://trentrichardson.com/examples/timepicker/jquery-ui-sliderAccess.js"></script>
 
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.4/dist/umd/supabase.min.js"></script>

<link rel="stylesheet" href="css/styles.css"> 

</head>

<body>
  <div class="container register">
    <div class="row">
      <div class="col-md-12">
        <div class="tab-pane fade show active text-align form-new" id="home" role="tabpanel" aria-labelledby="home-tab">
          <h3 class="register-heading text-nowrap">RESENHAS E OPERA√á√ïES</h3>
          <div class="row register-form">
            <div class="col-md-12">
              <form id="resenhaForm">

        <div class="header-bar">
    <span id="user-info">Usu√°rio: <strong>Carregando...</strong></span>
    <button onclick="logout()" class="logout-small">
        Sair
    </button>
</div>




                <div class="form-group">
                  <select class="form-control" id="type" name="departamento">
                    <option value="Departamento">Selecione o Departamento</option>
                    <option value="*DECAP*">DECAP</option>
                    <option value="*DEINTER-1*">DEINTER-1</option>
                    <option value="*DEINTER-6*">DEINTER-6</option>
                    <option value="*DEIC*">DEIC</option>
                    <option value="*DPPC*">DPPC</option>
                  </select>
                  <select class="form-control" name="seccional" id="seccional2">
                    <option value="">Selecione a Seccional</option>
                  </select>
                  <select class="form-control" name="delegacia" id="delegacia2">
                    <option value="">Selecione a Unidade</option>
                  </select>
                </div>

                <div class="form-group">
                  <div class="input-group">
                    <input type="text" class="form-control" id="rdoInput" placeholder="N√∫mero do Procedimento" onkeyup="this.value = this.value.toUpperCase();" name="rdo" required>
                    <div class="input-group-append">
                      <button type="button" class="btnBuscar" onclick="buscarRDO()">üîéBuscar Registro</button>
                    </div>
                  </div>
                </div>

                <!-- Modal para selecionar registro -->
                <div id="resultadoModal" style="display: none; padding: 10px; border: 1px solid black; background-color: #f9f9f9; margin-top: 10px;">
                  <h5>Selecione um registro:</h5>
                  <ul id="resultadoLista"></ul>
                </div>

                <div class="form-group">
                  <input type="text" name="data" id="datepicker" class="form-control" placeholder="Data" required>
                </div>

                <div class="form-group">
                  <input type="text" name="natureza" class="form-control" placeholder="Natureza" onkeyup="this.value = this.value.toUpperCase();">
                </div>

                <div class="form-group">
                  <select class="form-control" name="ocorrencia">
                    <option value="">Selecione o tipo de ocorr√™ncia</option>
                    <option value="*FLAGRANTE*">FLAGRANTE</option>
                    <option value="*TERMO CIRCUNSTANCIADO*">TERMO CIRCUNSTANCIADO</option>
                    <option value="*BOLETIM DE OCORR√äNCIA*">BOLETIM DE OCORR√äNCIA</option>
                    <option value="*ATO INFRACIONAL*">ATO INFRACIONAL</option>
                    <option value="*PRIS√ÉO TEMPOR√ÅRIA*">PRIS√ÉO TEMPOR√ÅRIA</option>
                    <option value="*PRIS√ÉO PREVENTIVA*">PRIS√ÉO PREVENTIVA</option>
                    <option value="*MANDADO DE BUSCA E APREENS√ÉO*">MANDADO DE BUSCA E APREENS√ÉO</option>
                  </select>
                </div>

                <div class="form-group">
                  <input type="text" name="envolvidos" class="form-control" onkeyup="this.value = this.value.toUpperCase()" placeholder="ex.: 1 PRESO, 1 ADOLESCENTE INFRATOR, 2 INDICIADOS">
                </div>

                <div class="form-group">
                  <input type="text" name="localfato" class="form-control" onkeyup="this.value = this.value.toUpperCase();" placeholder="Endere√ßo do fato">
                </div>

                <div class="form-group">
                  <textarea name="historico" class="form-control" placeholder="Breve resumo da ocorr√™ncia" style="height:200px" onkeyup="this.value = this.value.toUpperCase();" required></textarea>
                </div>

                <div class="form-group">
  <label class="switch-container">
    <input type="checkbox" name="eh_operacao" id="isOperacao" onchange="toggleOperacaoFields()">
    <span class="slider round"></span>
    <span class="checkbox-label">Marcar se for uma Opera√ß√£o Policial</span>
  </label>
</div>



 <div id="operacaoFields" style="display: none; padding: 15px; border-radius: 8px; margin-top: 15px; ">
  <h5 style="margin-bottom: 15px;">Informa√ß√µes da Opera√ß√£o</h5>

  <div class="form-grid">
    <div class="form-group">
      <label>Nome da Opera√ß√£o</label>
      <input type="text" class="form-control" name="nome_operacao" placeholder="Ex: Opera√ß√£o F√™nix" onblur="this.value = capitalizeWords(this.value)">
    </div>

    <div class="form-group">
      <label>N√∫mero do Inqu√©rito</label>
      <input type="text" class="form-control" name="numero_inquerito" placeholder="Ex: 123456/2024" onblur="this.value = capitalizeWords(this.value)">
    </div>
  </div>

  <div class="form-group">
    <label>Objetivo da Opera√ß√£o</label>
    <input type="text" class="form-control" name="objetivo_operacao" placeholder="Ex: Repress√£o ao tr√°fico de drogas" onblur="this.value = capitalizeWords(this.value)">
  </div>

  <div class="form-grid">
    <div class="form-group">
      <label>Efetivo Utilizado</label>
      <input type="text" class="form-control" name="efetivo_operacao" placeholder="Ex: 10 policiais" onblur="this.value = capitalizeWords(this.value)">
    </div>

    <div class="form-group">
      <label>Total de Viaturas</label>
      <input type="number" class="form-control" name="viaturas_utilizadas" placeholder="Ex: 5">
    </div>
  </div>

  <div class="form-grid">
    <div class="form-group">
      <label>Mandados de Busca</label>
      <input type="number" class="form-control" name="mandados_busca" placeholder="Ex: 3">
    </div>

    <div class="form-group">
      <label>Mandados de Pris√£o</label>
      <input type="number" class="form-control" name="mandados_prisao" placeholder="Ex: 2">
    </div>
  </div>

<div class="form-group">
  <label>Pris√µes Realizadas / Procurados:</label>
  <div class="tags-wrapper">
    <div id="tagsPrisoes" class="tags-container">
      <input
        type="text"
        class="form-control input-tags"
        id="inputPrisoes"
        placeholder="Ex: 2 pris√µes preventivas - Digite e pressione Enter"
	onblur="onInputBlur(event, 'prisoes')"
      />
    </div>
    <button type="button" class="btn-add" onclick="adicionarTag('prisoes')">‚ûï</button>
  </div>
</div>



<!-- Apreens√µes -->
<div class="form-group">
  <label>Apreens√µes (Drogas, Armas, Outros):</label>
  <div class="tags-wrapper">
    <div class="tags-container" id="tagsApreensoes">
   <input type="text" class="form-control input-tags" id="inputApreensoes" placeholder="Ex: 500g de coca√≠na, 2 armas - Digite e pressione Enter" onblur="onInputBlur(event, 'apreensoes')">
    </div>
    <button type="button" class="btn-add" onclick="adicionarTag('apreensoes')">‚ûï</button>
  </div>
</div>

<!-- Ve√≠culos Recuperados -->
<div class="form-group">
  <label>Ve√≠culos Recuperados:</label>
  <div class="tags-wrapper">
    <div class="tags-container" id="tagsVeiculos">
      <input type="text" class="form-control input-tags" id="inputVeiculos" placeholder="Ex: 2 ve√≠culos, 1 moto - Digite e pressione Enter" onblur="onInputBlur(event, 'veiculos')">
    </div>
    <button type="button" class="btn-add" onclick="adicionarTag('veiculos')">‚ûï</button>
  </div>
</div>





  <div class="form-group">
    <label>Outras Informa√ß√µes</label>
    <textarea class="form-control" name="outros" placeholder="Detalhes adicionais da opera√ß√£o"></textarea>
  </div>
</div>


<div class="form-group">
  <label for="fotoUpload">üì∑ Upload de Fotos:</label>
  <input type="file" class="form-control" id="fotoUpload" multiple accept="image/*">
  <input type="button" class="btnSubmit btn-upload" value="üì§ Enviar Fotos" onclick="uploadFotos()">
</div>

      <!-- üìÇ Fotos a Enviar (Preview) -->
      <div id="fotosPreviewContainer" style="display: none;">
          <h3 id="fotosPreviewTitle" style="border-bottom: 2px solid #000; padding-bottom: 5px;">üìÇ Fotos a Enviar</h3>
          <div id="fotosPreview" style="display: flex; flex-wrap: wrap; gap: 10px;"></div>
      </div>

      <!-- üìÅ Fotos J√° Enviadas -->
      <div id="fotosSalvasContainer" style="display: none;">
          <h3 id="fotosSalvasTitle" style="border-bottom: 2px solid #000; padding-bottom: 5px;">üìÅ Fotos J√° Enviadas</h3>
          <div id="fotosSalvas" style="display: flex; flex-wrap: wrap; gap: 10px;"></div>
      </div>

<div class="form-group">
  <input type="button" class="btnSubmit btn-clear" value="üßπ Limpar Formul√°rio" onclick="resetFormulario()">
</div>

<div class="form-group">
  <input type="submit" class="btnSubmit" value="üíæ Gerar e Salvar Informa√ß√µes">
</div>

<div class="form-group">
  <input type="button" id="gerar-pdf" class="btnSubmit btn-pdf" value="üìÑ Gerar PDF - Formul√°rio Opera√ß√£o">
  <p id="status-pdf" style="font-weight: bold; text-align: center;"></p>
  <div id="progress-bar-container">
    <div id="progress-bar"></div>
  </div>
</div>




              </form>
              <br>
              <div id="resultado" style="border: solid black 1px; border-radius: 8px;">
                <p><b>*Pol√≠cia Civil*</b></p>
                <p><b id="departamento"></b></p>
                <p><b id="seccional"></b></p>
                <p><b id="delegacia"></b></p>
                <p id="rdo"></p>
                <p id="data"></p>
                <p id="natureza"></p>
                <p><b id="ocorrencia"></b></p>
                <p id="envolvidos"></p>
                <p id="localfato"></p>
                <p id="historico"></p>
              </div>
              <div class="form-group">
  <button
  type="button"
  class="btnSubmit btn-upload"
  onclick="gotowhatsapp()"
>
  <img
    src="img/whatsapp-icon.svg"
    alt="WhatsApp"
    style="height: 20px; margin-right: 5px;"
  />
  Encaminhar RESENHA via WhatsApp
</button>
</div>
            </div>
          </div>
        </div>
      </div>
    </div>

<!-- Template do PDF (oculto) -->
<div id="pdf-content" style="display: none; font-family: Arial, sans-serif; font-size: 12px; padding: 0px 20px 20px 20px;">
  <table style="width: 97%; border-collapse: collapse; margin: 0 auto;">
     <tbody>
      <tr>
        <td style="border: 1px solid #000; padding: 5px;">Departamento</td>
        <td style="border: 1px solid #000; padding: 5px;" id="pdf-departamento"></td>
      </tr>
      <tr>
        <td style="border: 1px solid #000; padding: 5px;">Delegacia Seccional</td>
        <td style="border: 1px solid #000; padding: 5px;" id="pdf-seccional"></td>
      </tr>
      <tr>
        <td style="border: 1px solid #000; padding: 5px;">Unidade da Ocorr√™ncia</td>
        <td style="border: 1px solid #000; padding: 5px;" id="pdf-delegacia"></td>
      </tr>
      <tr>
        <td style="border: 1px solid #000; padding: 5px;">Nome da Opera√ß√£o</td>
        <td style="border: 1px solid #000; padding: 5px;" id="pdf-operacao"></td>
      </tr>
      <tr>
        <td style="border: 1px solid #000; padding: 5px;">Data da Ocorr√™ncia</td>
        <td style="border: 1px solid #000; padding: 5px;" id="pdf-data"></td>
      </tr>
      <tr>
        <td style="border: 1px solid #000; padding: 5px;">N√∫mero do RDO</td>
        <td style="border: 1px solid #000; padding: 5px;" id="pdf-rdo"></td>
      </tr>
      <tr>
        <td style="border: 1px solid #000; padding: 5px;">N√∫mero do Inqu√©rito Policial</td>
        <td style="border: 1px solid #000; padding: 5px;" id="pdf-inquerito"></td>
      </tr>
      <tr>
        <td style="border: 1px solid #000; padding: 5px;">Endere√ßo da Ocorr√™ncia</td>
        <td style="border: 1px solid #000; padding: 5px;" id="pdf-endereco"></td>
      </tr>
      <tr>
        <td style="border: 1px solid #000; padding: 5px;">Objetivo da Ocorr√™ncia</td>
        <td style="border: 1px solid #000; padding: 5px;" id="pdf-objetivo"></td>
      </tr>
      <tr>
        <td style="border: 1px solid #000; padding: 5px;">Efetivo Utilizado</td>
        <td style="border: 1px solid #000; padding: 5px;" id="pdf-efetivo"></td>
      </tr>
      <tr>
        <td style="border: 1px solid #000; padding: 5px;">Total de Viaturas</td>
        <td style="border: 1px solid #000; padding: 5px;" id="pdf-viaturas"></td>
      </tr>
      <tr>
        <td style="border: 1px solid #000; padding: 5px;">Mandados de Busca</td>
        <td style="border: 1px solid #000; padding: 5px;" id="pdf-mandados-busca"></td>
      </tr>
      <tr>
        <td style="border: 1px solid #000; padding: 5px;">Mandados de Pris√£o</td>
        <td style="border: 1px solid #000; padding: 5px;" id="pdf-mandados-prisao"></td>
      </tr>
      <tr>
        <td style="border: 1px solid #000; padding: 5px;">Pris√£o Realizada / Natureza Jur√≠dica</td>
        <td style="border: 1px solid #000; padding: 5px;" id="pdf-prisoes"></td>
      </tr>
      <tr>
        <td style="border: 1px solid #000; padding: 5px;">Apreens√µes (drogas em gramas)</td>
        <td style="border: 1px solid #000; padding: 5px;" id="pdf-apreensoes"></td>
      </tr>
      <tr>
        <td style="border: 1px solid #000; padding: 5px;">Ve√≠culos Recuperados</td>
        <td style="border: 1px solid #000; padding: 5px;" id="pdf-veiculos"></td>
      </tr>
      <tr>
        <td style="border: 1px solid #000; padding: 5px;">Outros</td>
        <td style="border: 1px solid #000; padding: 5px;" id="pdf-outros"></td>
      </tr>
<tr>
  <td colspan="2" style="border: 1px solid #000; padding: 5px; text-align: CENTER;"><strong>RESENHA DA OCORR√äNCIA</strong></td>
</tr>
<tr>
  <td colspan="2" style="padding: 0px; border: 1px solid #000;">
    <div id="pdf-resenha">
      <!-- Resenha ser√° inserida aqui -->
    </div>
  </td>
</tr>
    </tbody>
  </table>
<div id="pdf-fotos-container">
  <h3 id="pdf-fotos-titulo" style="text-align: center;">Fotos da Opera√ß√£o</h3>
  <div id="pdf-fotos">

  </div>
</div>



    



    <script src="https://cdn.jsdelivr.net/npm/compressorjs@1.2.1/dist/compressor.min.js"></script>


<script src="script.js" defer></script>


</body>
</html>




